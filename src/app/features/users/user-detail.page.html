@if (form) {
<div class="card" style="margin-bottom:12px;">
  <div class="card__title">Usuario</div>
  <div class="card__subtitle">Editar datos básicos</div>
  <form [formGroup]="form" (ngSubmit)="save()" class="grid">
    <div>
      <label for="fullName">Nombre completo</label>
      <input type="text" id="fullName" formControlName="fullName" />
    </div>
    <div>
      <label for="email">Email</label>
      <input type="email" id="email" formControlName="email" />
    </div>
    <div>
      <label for="username">Usuario</label>
      <input type="text" id="username" formControlName="username" />
    </div>
    <div>
      <label for="phone">Teléfono</label>
      <input type="tel" id="phone" formControlName="phone" />
    </div>
    <div>
      <label for="bio">Bio</label>
      <input type="text" id="bio" formControlName="bio" />
    </div>
    <div>
      <label for="countryCode">País</label>
      <input type="text" id="countryCode" formControlName="countryCode" />
    </div>
    <div>
      <label for="locale">Locale</label>
      <input type="text" id="locale" formControlName="locale" />
    </div>
    <div>
      <label for="timezone">Zona horaria</label>
      <input type="text" id="timezone" formControlName="timezone" />
    </div>
    <div class="actions">
      <button class="btn-primary" type="submit">Guardar</button>
    </div>
  </form>
</div>

<div class="row">
  <div class="card">
    <div class="card__title">Estado</div>
    <button class="btn-secondary" (click)="toggleStatus()">{{isActive ? 'Desactivar' : 'Activar'}}</button>
  </div>

  <div class="card">
    <div class="card__title">Roles</div>
    <label><input type="checkbox" [checked]="has('user')" (change)="toggleRole('user', $event)" /> user</label>
    <label><input type="checkbox" [checked]="has('admin')" (change)="toggleRole('admin', $event)" /> admin</label>
    <label><input type="checkbox" [checked]="has('super-user')" (change)="toggleRole('super-user', $event)" />
      super-user</label>
  </div>
</div>

<div class="card" style="margin-top:12px;">
  <div class="card__title" style="display:flex; align-items:center; justify-content:space-between;">
    <span>Auditoría</span>
    <button class="btn-ghost" (click)="loadAudit()">Recargar</button>
  </div>
  <ul>
    @for (a of audits; track $index) {
    <li>{{a.createdAt}} - {{a.action}}</li>
    }
  </ul>
</div>

<div class="card" style="margin-top:12px;">
  <div class="card__title">Eliminar</div>
  <div class="actions">
    <button class="btn-secondary" (click)="remove()">Eliminar (soft)</button>
    <button class="btn-ghost" (click)="restore()">Restaurar</button>
  </div>
</div>
} @else {
<div class="card"><app-loading-indicator></app-loading-indicator></div>
}